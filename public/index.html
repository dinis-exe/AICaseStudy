<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical Exam Analysis AI</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        /* Minimal inline styling for the profile selection modal */
        #profile-selection-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.75);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }
        #profile-selection-modal .modal-content {
            background: #fff;
            padding: 2rem;
            border-radius: 8px;
            text-align: center;
        }
        #profile-selection-modal button {
            margin: 0.5rem;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <nav>
        <div class="logo">ExaminAI</div>
        <ul>
            <li><a href="/"><i class="fas fa-home"></i> Home</a></li>
            <li><a href="/about"><i class="fas fa-info-circle"></i> About</a></li>
            <li><a href="/contact"><i class="fas fa-envelope"></i> Contact</a></li>
            <li><a href="/profile" id="profile-link"><i class="fas fa-user"></i> Profile</a></li>
            <li><a href="/#" id="login-link"><i class="fas fa-sign-in-alt"></i> Login</a></li>
            <li><a href="/logout" id="logout-link" style="display: none;"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
            <li><button id="dark-mode-toggle"><i class="fas fa-moon"></i></button></li>
        </ul>
    </nav>
    
    <!-- Profile Selection Modal -->
    <div id="profile-selection-modal">
        <div class="modal-content">
            <h2>Escolha o seu perfil</h2>
            <p>Selecione "Utentes" ou "Hospitais" para prosseguir</p>
            <button id="patient-btn">Utentes</button>
            <button id="hospital-btn">Hospitais</button>
        </div>
    </div>
    
    <!-- New Login Selection Modal -->
    <div id="login-selection-modal" style="display:none; position: fixed; top: 0; left: 0; width: 100%; height:100%; background: rgba(0,0,0,0.75); justify-content: center; align-items: center; z-index: 2000;">
        <div style="background: #fff; padding: 2rem; border-radius: 8px; text-align: center;">
            <h2>Escolha o tipo de login</h2>
            <p>Selecione "Utente" ou "Hospital" para prosseguir</p>
            <button id="utente-login" style="margin: 0.5rem; padding: 0.5rem 1rem;">Utente Login</button>
            <button id="hospital-login-btn" style="margin: 0.5rem; padding: 0.5rem 1rem;">Hospital Login</button>
        </div>
    </div>
    
    <div class="container">
        <h1>Medical Exam Analysis AI</h1>
        <form id="upload-form">
            <label for="image-input" class="custom-file-upload">
                <i class="fas fa-cloud-upload-alt"></i> Choose Image
            </label>
            <input type="file" id="image-input" accept="image/*" required>
            <button type="submit" class="btn"><i class="fas fa-upload"></i> Upload Image</button>
        </form>
        <div id="image-preview-container">
            <h2 id="image-preview-text" style="display: none">Image Preview:</h2>
            <img id="image-preview" src="#" alt="Image Preview" style="display: none";/>
        </div>
        <div id="result">
            <h2>Diagnosis:</h2>
            <p id="diagnosis"></p>
            <h2>Probability:</h2>
            <p id="probability"></p>
        </div>
    </div> <!-- End of container -->
    <!-- New AI Efficiency Dashboard section -->
    <footer>
        <p>&copy; 2025 ExaminAI. All rights reserved.</p>
    </footer>
    <script src="script.js"></script>
    <script>
        // filepath: /Users/dinislima/Documents/AICaseStudy/public/index.html
        // Hide profile selection modal if a profile has already been chosen
        if (localStorage.getItem('user-profile')) {
            document.getElementById('profile-selection-modal').style.display = 'none';
        }

        // Handle profile selection modal: store selection and redirect to appropriate login
        document.getElementById('patient-btn').addEventListener('click', function() {
            localStorage.setItem('user-profile', 'utente');
            window.location.href = '/login?profile=utente';
        });
        document.getElementById('hospital-btn').addEventListener('click', function() {
            localStorage.setItem('user-profile', 'hospital');
            window.location.href = '/hospital-login';
        });
        
        // New login selection modal: show when login link is clicked
        const loginLink = document.getElementById('login-link');
        const loginModal = document.getElementById('login-selection-modal');
        loginLink.addEventListener('click', function(event) {
            event.preventDefault();
            loginModal.style.display = 'flex';
        });
        
        document.getElementById('utente-login').addEventListener('click', function() {
            window.location.href = '/login?profile=utente';
        });
        document.getElementById('hospital-login-btn').addEventListener('click', function() {
            window.location.href = '/hospital-login';
        });
    </script>
</body>
</html>
